<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Jornada Divertida</title>

    <link rel="icon" href="data:,">

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>

    <header>
        <h1>Mi Jornada</h1>
        <div id="user-info" class="hidden">
            <span id="user-email"></span>
            <button id="logout-button">Salir</button>
        </div>
    </header>

    <main>
        <section id="auth-view">
            <h2>¡Bienvenido!</h2>
            <form id="login-form">
                <input type="email" id="login-email" placeholder="Correo" required>
                <input type="password" id="login-password" placeholder="Contraseña" required>
                <button type="submit">Ingresar</button>
            </form>
        </section>

        <section id="app-view" class="hidden">
            <div class="date-filter-container">
                <label for="date-filter">Ver tareas del día:</label>
                <input type="date" id="date-filter">
                <button id="today-button">Hoy</button>
            </div>

            <div class="report-container">
                <button id="generate-morning-report-button">Reporte Mañana</button>
                <button id="generate-afternoon-report-button">Reporte Tarde</button>
                <button id="generate-weekly-report-button">Generar Reporte Semanal</button>
            </div>

            <div id="selected-date-display" class="selected-date">
                Mostrando tareas del: <span id="selected-date-text"></span>
            </div>

            <div class="tasks-container">
                <h2>Tareas de la Mañana</h2>
                <div class="tasks-group">
                    <h3 class="tasks-group-title">Pendientes y En Negociación</h3>
                    <div id="morning-tasks-pending" class="task-list"></div>
                </div>
                <div class="tasks-group">
                    <h3 class="tasks-group-title">Completadas y Validadas</h3>
                    <div id="morning-tasks-completed" class="task-list task-list-completed"></div>
                </div>
            </div>

            <div class="tasks-container">
                <h2>Tareas de la Tarde</h2>
                <div class="tasks-group">
                    <h3 class="tasks-group-title">Pendientes y En Negociación</h3>
                    <div id="afternoon-tasks-pending" class="task-list"></div>
                </div>
                <div class="tasks-group">
                    <h3 class="tasks-group-title">Completadas y Validadas</h3>
                    <div id="afternoon-tasks-completed" class="task-list task-list-completed"></div>
                </div>
            </div>
            
            <div class="tasks-container">
                <h2>Penalidades del Día</h2>
                <div id="penalties-list" class="task-list"></div>
            </div>
            <button id="add-task-button" class="fab">+</button>
        </section>
    </main>

    <div id="add-task-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Nueva Tarea</h2>
            <form id="add-task-form">
                <input type="text" id="task-title" placeholder="Título de la tarea" required>
                <textarea id="task-description" placeholder="Descripción..." required></textarea>
                <input type="datetime-local" id="task-deadline" required>
                <label>
                    <input type="checkbox" id="task-mandatory">
                    ¿Es obligatoria?
                </label>
                <button type="submit">Guardar Tarea</button>
            </form>
        </div>
    </div>

    <div id="camera-modal" class="modal hidden">
        <div class="modal-content">
            <video id="camera-feed" autoplay playsinline></video>
            <button id="capture-button">Tomar Foto</button>
            <canvas id="photo-canvas" class="hidden"></canvas>
            <button id="upload-button" class="hidden">Subir Evidencia</button>
        </div>
    </div>
    
    <div id="comment-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Añadir Comentario</h2>
            <form id="comment-form">
                <textarea id="comment-text" placeholder="Escribe tu comentario..." required></textarea>
                <button type="submit">Enviar Comentario</button>
            </form>
        </div>
    </div>

    <div id="report-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="report-modal-title">Reporte de Cumplimiento</h2>
            <div id="report-content"></div>
            <div id="report-actions" class="hidden">
                <hr>
                <button id="assign-reward-button">Asignar Recompensa</button>
            </div>

            <div id="penalty-actions" class="hidden">
                <hr>
                <h3>Sugerir una Penalidad</h3>
                <form id="penalty-form">
                    <input type="text" id="penalty-title" placeholder="Título de la penalidad" required>
                    <textarea id="penalty-description" placeholder="Descripción de la penalidad..." required></textarea>
                    <input type="datetime-local" id="penalty-deadline" required>
                    <button type="submit">Sugerir Penalidad</button>
                </form>
            </div>

            <button id="close-report-button">Cerrar</button>
        </div>
    </div>

    <div id="weekly-report-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Reporte Semanal de Cumplimiento</h2>
            <div id="weekly-report-content"></div>
            <div id="weekly-report-actions" class="hidden">
            </div>
            <button id="close-weekly-report-button">Cerrar</button>
        </div>
    </div>

    <div id="reward-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Asignar Recompensa</h2>
            <form id="reward-form">
                <textarea id="reward-text" placeholder="Describe la recompensa..." required></textarea>
                <button type="submit">Guardar Recompensa</button>
            </form>
        </div>
    </div>

    <div id="negotiation-modal" class="modal hidden">
        <div class="modal-content">
            <h2 id="negotiation-modal-title">Proponer Alternativa</h2>
            <form id="negotiation-form">
                <input type="text" id="negotiation-title" placeholder="Nuevo título de la penitencia" required>
                <textarea id="negotiation-description" placeholder="Nueva descripción..." required></textarea>
                <button type="submit">Enviar Propuesta</button>
            </form>
        </div>
    </div>

    <div id="supervisor-rejection-options-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Rechazar Propuesta</h2>
            <p>La contrapropuesta del supervisado será rechazada. ¿Qué deseas hacer a continuación?</p>
            <div class="modal-actions">
                <button id="restore-original-penalty-btn">Restaurar Penalidad Original</button>
                <button id="propose-new-penalty-btn">Hacer una Contrapropuesta</button>
            </div>
        </div>
    </div>

    <div id="ai-assistance-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Asistencia de IA para Penalidad</h2>
            <p>Se ha alcanzado el límite de negociaciones. Copia el siguiente texto y pégalo en tu IA de preferencia para obtener una penalidad justa y razonable.</p>
            <pre id="ai-prompt-container"></pre>
            <hr>
            <h3>Establecer Penalidad Final</h3>
            <form id="final-penalty-form">
                <input type="text" id="final-penalty-title" placeholder="Título de la penalidad final" required>
                <textarea id="final-penalty-description" placeholder="Descripción de la penalidad final..." required></textarea>
                <button type="submit">Guardar Penalidad Final</button>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script type="module" src="js/main.js"></script>

</body>
</html>